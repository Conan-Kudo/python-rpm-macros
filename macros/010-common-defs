%system_python python2

##### fedora compatibility #####

%py_setup setup.py
%py_shbang_opts -s

##### binary suffixes for flavors #####

%python2_bin_suffix %python2_version
%python3_bin_suffix %python3_version
%pypy3_bin_suffix   pp%{pypy3_version}

##### fallback preferred configuration #####

# This can't be in a conditional section because there are no conditional
# sections. Instead, `python2` is hardcoded here, to be reconfigured through
# future package updates (supposedly).

%python_sitelib          %python2_sitelib
%python_sitearch         %python2_sitearch
%python_version          %python2_version
%python_version_nodots   %python2_version_nodots
%python_prefix           %python2_prefix

%python_bin_suffix       %python2_bin_suffix

%_rec_macro_helper %{lua:
    rpm.define("_rec_macro_helper %{nil}")
    function recurse_macro(name)
        local aa = rpm.expand("%**")
        print(rpm.expand("%{" .. name .. " " .. aa .."}"))
    end}

%python_alternative()           %{_rec_macro_helper}%{lua:recurse_macro("python2_alternative")}
%python_install_alternative()   %{_rec_macro_helper}%{lua:recurse_macro("python2_install_alternative")}
%python_uninstall_alternative() %{_rec_macro_helper}%{lua:recurse_macro("python2_uninstall_alternative")}

%py_ver  %python_version
